# This file defines a series of classifiers, performed in order (after sorting
# the [table_names]).  Each table name consists of:
#     xy-name-acts_on
# split by "-", where:
#     - xy: is a number for sorting (lowest is applied first)
#     - name: a human-readable string
#
# In addition, every section (other than "Meta") must contain an
#     acts_on =
# key.  Its value can be:
#     - filenames: a list of strings
#     - summary: the first line of the commit message
#     - message: the full (often multi-line) commit message

[Meta]

# If we attempt to classify via filenames and the initial attempt fails,
# omit any names in this list and try again.
_filenames_try_omit = [
    '.*/tests/.*',
    '.*\.[1-9]',
    'UPDATING',
    'tests/.*',
]


[00-reverts]

_acts_on = "message"

# We need to find the 'This reverts...' string anywhere in the commit message.
_re_func = "search"

reverts = [
    'This reverts commit \b([0-9a-fA-F]{40})\b',
]


[01-style]

_acts_on = "summary"

# We need to find a pattern anywhere in the commit summary.
_re_func = "search"

style = [
    '[sS]tyle',
    '[tT]ypo',
    '[wW]hitespace',
]


[02-filenames_wildcards]

_acts_on = "filenames"

doc = [
    '.*\.[1-9]',
]

build = [
    '.*BSDmakefile',
    '.*Makefile',
    'release/.*',
]


[02b-filenames_wildcards2]
# We need this to not catch '.*Makefile', but it's not worth renumbering all
# the subsequent section names since that will cause a huge git diff.

_acts_on = "filenames"

tests = [
    'bin/.*/test/.*', # special case for ed
    'bin/.*/tests/.*',
    'sbin/.*/tests/.*',
    'usr.bin/.*/test/.*', # special case for ctags
    'usr.bin/.*/tests/.*',
    'usr.sbin/.*/tests/.*',
]


[03-filenames_plain1]

_acts_on = "filenames"

userland = [
    'bin/',
]

doc = [
    'RELNOTES',
    'tools/kerneldoc/',
    'usr.bin/man/',
    'usr.bin/mandoc/',
]

hardware = [
    "share/misc/pci_vendors",
    "share/misc/usb_vendors",
    "sys/amd64/",
    "sys/arm/",
    "sys/arm64/",
    "sys/dev/",
    "sys/i386/",
    "sys/powerpc/",
    "sys/riscv/",
    "sys/x86/",
]

network = [
    'krb5/',
    'share/sendmail/',
    'sys/net/',
    'sys/net80211/',
    'sys/netgraph/',
    'sys/netinet/',
    'sys/netinet6/',
    'sys/netipsec/',
    'sys/netlink/',
    'sys/netpfil/',
    'sys/netsmb/',
    'sys/nfs/',
    'sys/nfsclient/',
    'sys/nfsserver/',
    'usr.bin/netstat/',
    'usr.bin/sockstat/',
    'usr.sbin/ctld/',
]

admin = [
    'etc/',
    'libexec/',
    'sbin/',
    'stand/',
]

libs = [
    'secure/lib/',
]

filesystems = [
    'sys/fs/',
    'sys/ufs/',
]

build = [
    '.github/workflows/',
    'Makefile',
    'share/mk/',
    'tools/build/',
]

internal = [
    '.git-blame-ignore-revs',
    'ObsoleteFiles.inc',
    'share/misc/bsd-family-tree',
    'share/misc/committers-ports.dot',
    'share/misc/committers-src.dot',
]

tests = [
    'lib/libc/tests/',
    'tests/',
    'tools/regression/',
    'tools/test/',
]

contrib = [
    'contrib/',
    'crypto/openssl/',
    'sys/contrib',
]

[04-filenames_plain2]

_acts_on = "filenames"

userland = [
    'usr.bin/',
]

# Must be 2nd pass due to 'lib/libc/tests'
libs = [
    'lib/',
]

# Must be 2nd pass due to 'usr.sbin/ctld/'
admin = [
    'usr.sbin/',
]

# Must be 2nd pass due to 'sys/fs/'
kernel = [
    'sys/',
]


[05-summary-prefix]

_acts_on = "summary"

userland = [
]

doc = [
    '.*\.[1-9]:',
    'UPDATING',
    'man .*',
]

hardware = [
    'GEOM:',
    'moused\(8\):',
    'udbc:',
    'virtual_oss:',
]

network = [
    'epair:',
    'ip6:',
    'pf:',
    'sys/netinet6:',
    'tcp:',
    'vtnet:',
]

admin = [
    'cpucontrol:',
    'jail:',
    'jaildesc:',
    'nanobsd:',
    'pci_user:',
    'tty:',
]

libs = [
    'lib.*:',
]

filesystems = [
    'fusefs:',
    'pseudofs:',
    'vfs:',
    'zfs:',
    'zfsd:',
]

kernel = [
    'vmm:',
]

build = [
    'bsd\..*\.mk:',
    'packages:',
    'release:',
    'src\..*\.mk:',
]

internal = [
]

contrib = [
    'OpenSSL:',
    'dtrace:',
]
